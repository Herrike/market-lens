import{r as o,j as r,F as v,H as N}from"./react-DLqcGry3.js";import{u as S,a as k}from"./services-C5ZnUbBO.js";import{h as w,H as P}from"./charts-B-JtCvON.js";const u=o.createContext({searchQuery:"",searchModalToggle:!1,selectedStock:"",setSearchQuery:()=>{},setSearchModalToggle:()=>{},setSelectedStock:()=>{}}),g=["^GSPC","^DJI","^IXIC","^RUT","^FTSE","^N225","^HSI","^STOXX50E","^VIX"],x={"^GSPC":"S&P 500","^DJI":"Dow Jones","^IXIC":"NASDAQ","^RUT":"Russell 2000","^FTSE":"FTSE 100","^N225":"Nikkei 225","^HSI":"Hang Seng","^STOXX50E":"Euro Stoxx 50","^VIX":"VIX"};function E(e){return g.includes(e)}const m=(e,t)=>{const s={code:e,message:t||`HTTP ${e} Error`};switch(e){case 400:return{...s,name:"BadRequestError",status:e,userMessage:"Invalid request. Please check your input and try again.",retryable:!1,suggestion:"Verify that you've entered a valid stock symbol (e.g., AAPL, MSFT)."};case 401:return{...s,name:"UnauthorizedError",status:e,userMessage:"Authentication required. Please check your API credentials.",retryable:!1,suggestion:"Your API key may be invalid or expired."};case 403:return{...s,name:"ForbiddenError",status:e,userMessage:"Access denied. Please check your permissions or try again later.",retryable:!0,suggestion:"You may have exceeded your API quota. Consider upgrading your plan or try popular stocks like AAPL, MSFT, GOOGL."};case 404:return{...s,name:"NotFoundError",status:e,userMessage:"The requested data was not found.",retryable:!1,suggestion:"Please check the stock symbol and try again."};case 429:return{...s,name:"TooManyRequestsError",status:e,userMessage:"Too many requests. Please wait a moment and try again.",retryable:!0,suggestion:"Wait 30-60 seconds before making another request."};case 500:return{...s,name:"InternalServerError",status:e,userMessage:"Server error occurred. Please try again later.",retryable:!0,suggestion:"This is a temporary server issue. Please retry in a few minutes."};case 502:return{...s,name:"BadGatewayError",status:e,userMessage:"Service temporarily unavailable. Please try again later.",retryable:!0,suggestion:"The service is experiencing issues. Please try again in a few minutes."};case 503:return{...s,name:"ServiceUnavailableError",status:e,userMessage:"Service unavailable. Please try again later.",retryable:!0,suggestion:"The service is under maintenance or overloaded. Please try again later."};case 504:return{...s,name:"GatewayTimeoutError",status:e,userMessage:"Request timeout. Please try again.",retryable:!0,suggestion:"The request timed out. Please try again with a more stable connection."};default:return{...s,name:e>=500?"ServerError":"ClientError",status:e,userMessage:e>=500?"Server error occurred. Please try again later.":"An unexpected error occurred. Please try again.",retryable:e>=500,suggestion:e>=500?"This appears to be a server issue. Please try again later.":"Please refresh the page and try again."}}},M=e=>m(e).suggestion,T=e=>{if(typeof e=="object"&&e!==null){if("status"in e&&typeof e.status=="number")return e.status===0?500:e.status;if("statusCode"in e&&typeof e.statusCode=="number")return e.statusCode;if("code"in e&&typeof e.code=="number")return e.code}return 500},F=(e,t="An unexpected error occurred")=>{const s=T(e);let a;return e instanceof Error?a=e.message:e==null?a=t:a=String(e),m(s,a)};function A(e,t){const s=t.data.map(n=>[new Date(n.date).getTime(),n.price]).reverse(),a=E(e)?`${x[e]} (${e})`:e;return{accessibility:{enabled:!1},title:{text:`${a} Price History`,style:{fontSize:"18px",fontWeight:"bold"}},subtitle:{text:"15-Day Historical Price Data",style:{fontSize:"14px",color:"#666"}},xAxis:{type:"datetime",title:{text:"Date"}},yAxis:{title:{text:"Price ($)"}},legend:{enabled:!1},series:[{type:"line",name:`${e} Price`,data:s,color:"#4f46e5",lineWidth:2,marker:{enabled:!1,states:{hover:{enabled:!0,radius:4}}}}],tooltip:{formatter:function(){const n=this.x,i=this.y;return`<b>${e}</b><br/>
                ${w.dateFormat("%B %e, %Y",n)}<br/>
                ${i?"Price: $"+i.toFixed(2):""}`}},responsive:{rules:[{condition:{maxWidth:500},chartOptions:{title:{style:{fontSize:"16px"}},subtitle:{style:{fontSize:"12px"}}}}]}}}const h=({symbol:e})=>r.jsxs("div",{className:"bg-gray-50 rounded-lg p-8 mb-6 text-center",children:[r.jsx("div",{className:"animate-pulse",children:r.jsx("div",{className:"h-64 bg-gray-200 rounded-lg mb-4"})}),r.jsxs("p",{className:"text-sm text-gray-500 mb-2",children:["Analysing ",e," history trend"]}),r.jsx("p",{className:"text-xs text-gray-400",children:"Loading historical price data..."})]}),I=({selectedStock:e,onSymbolSelect:t})=>r.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-6 mb-6",children:[r.jsxs("div",{className:"text-center mb-4",children:[r.jsx("div",{className:"bg-indigo-100 rounded-full p-3 w-16 h-16 mx-auto mb-3 flex items-center justify-center",children:r.jsx(v,{className:"h-8 w-8 text-indigo-600"})}),r.jsx("h2",{className:"text-lg font-semibold text-indigo-800 mb-2",children:"Upgrade to Premium"})]}),r.jsxs("div",{className:"bg-white rounded-lg p-4 mb-4",children:[r.jsxs("p",{className:"text-sm text-gray-700 mb-3",children:[r.jsx("strong",{children:"Individual stocks"})," like"," ",r.jsx("code",{className:"bg-gray-100 px-1 rounded",children:e})," ","require a paid Financial Modeling Prep subscription for historical data access."]}),r.jsxs("p",{className:"text-sm text-gray-700",children:["However, you can view historical charts for these"," ",r.jsx("strong",{children:"major market indices"})," on the free tier:"]})]}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 mb-4",children:g.map(s=>r.jsxs("button",{onClick:()=>t(s),className:"bg-white hover:bg-indigo-50 border border-indigo-200 rounded-lg p-3 text-left transition-colors duration-200 cursor-pointer",children:[r.jsx("div",{className:"font-medium text-indigo-800 text-sm",children:s}),r.jsx("div",{className:"text-xs text-gray-600",children:x[s]})]},s))}),r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-xs text-indigo-600 mb-2",children:"ðŸ’¡ Click any index above to view its historical chart"}),r.jsx("p",{className:"text-xs text-gray-500",children:"For individual stock charts, consider upgrading to a paid API plan"})]})]}),L=({errorInfo:e,suggestion:t})=>r.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 mb-6",children:r.jsxs("div",{className:"flex items-start",children:[r.jsx("svg",{className:"h-5 w-5 text-red-400 dark:text-red-300 mt-0.5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsxs("div",{className:"ml-3 flex-1",children:[r.jsx("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"Chart Error"}),r.jsx("p",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:e.userMessage}),t&&r.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400 mt-2 leading-relaxed",children:["ðŸ’¡ ",t]}),e.code===403&&r.jsx("div",{className:"mt-3 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-md",children:r.jsxs("p",{className:"text-xs text-yellow-700 dark:text-yellow-300",children:[r.jsx("strong",{children:"Mobile users:"})," Try these popular free symbols: AAPL, MSFT, GOOGL, TSLA, AMZN"]})})]})]})}),q=({selectedStock:e,quoteData:t})=>r.jsx("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-6 mb-6",children:r.jsxs("div",{className:"text-center",children:[r.jsx("h2",{className:"text-lg font-semibold text-indigo-800 mb-2",children:"Quote Available"}),r.jsx("p",{className:"text-sm text-indigo-600 mb-4",children:"Historical data requires a paid subscription. Showing current price data instead."}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[r.jsxs("div",{className:"bg-white rounded-lg p-3",children:[r.jsx("p",{className:"text-gray-600",children:"Current Price"}),r.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["$",t.quote.price.toFixed(2)]}),r.jsxs("p",{className:`text-sm ${t.quote.change>=0?"text-green-600":"text-red-600"}`,children:[t.quote.change>=0?"+":"",t.quote.change.toFixed(2)," (",t.quote.changesPercentage.toFixed(2),"%)"]})]}),r.jsxs("div",{className:"bg-white rounded-lg p-3",children:[r.jsx("p",{className:"text-gray-600",children:"Day Range"}),r.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:["$",t.quote.dayLow.toFixed(2)," - $",t.quote.dayHigh.toFixed(2)]})]}),r.jsxs("div",{className:"bg-white rounded-lg p-3",children:[r.jsx("p",{className:"text-gray-600",children:"52 Week Range"}),r.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:["$",t.quote.yearLow.toFixed(2)," - $",t.quote.yearHigh.toFixed(2)]})]}),r.jsxs("div",{className:"bg-white rounded-lg p-3",children:[r.jsx("p",{className:"text-gray-600",children:"Volume"}),r.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:[(t.quote.volume/1e6).toFixed(1),"M"]})]})]}),r.jsx("p",{className:"text-xs text-indigo-500 mt-4",children:"ðŸ’¡ Upgrade your API subscription to view historical charts and trends"})]})}),$=({selectedStock:e})=>r.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:[r.jsx("p",{className:"text-sm text-yellow-600 mb-2",children:"No historical data available"}),r.jsxs("p",{className:"text-xs text-yellow-500",children:["Historical price data for ",e," is not available."]})]}),H=()=>{const{selectedStock:e,setSelectedStock:t}=o.useContext(u),{data:s,error:a,isLoading:n}=S(e),i=a?.status===402,{data:l,error:b,isLoading:y}=k(i?e:""),p=n||i&&y,d=i?b:a;if(p)return r.jsx(h,{symbol:e});if(d&&!(i&&l)){const c=F(d,"Failed to load chart data"),f=M(c.code);return c.code===402||d.message.includes("402")?r.jsx(I,{selectedStock:e,onSymbolSelect:t}):r.jsx(L,{errorInfo:c,suggestion:f})}if(i&&l)return r.jsx(q,{selectedStock:e,quoteData:l});if(!s||s.data.length===0)return r.jsx($,{selectedStock:e});const j=A(e,s);return r.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6 mb-6 shadow-sm",children:r.jsx(N,{highcharts:P,options:j})})},R=()=>{const{selectedStock:e}=o.useContext(u);return e?r.jsx(o.Suspense,{fallback:r.jsx(h,{symbol:e}),children:r.jsx(H,{})}):null},G=Object.freeze(Object.defineProperty({__proto__:null,default:R},Symbol.toStringTag,{value:"Module"}));export{G as C,g as F,u as S,x as a,M as g,F as h};
